{% extends 'core/base.html' %}
{% block title %}About Villen Bhai ‚Äî The Mind Behind the Code{% endblock %}
{% load static %}

{% block custom_header %}
<header id="villen-header" class="text-center p-4 bg-dark text-light border-bottom border-info position-relative">
  <h1 class="display-4 fw-bold glow" id="villen-title" style="cursor: pointer;" role="button" aria-label="Toggle header buttons" tabindex="0">
    üåü Meet Villen Bhai
  </h1>
  <p class="fs-5 text-secondary mb-4">Code. Hack. Inspire. Repeat.</p>

  <div id="header-buttons" class="d-flex justify-content-center flex-wrap gap-3" style="display: none; opacity: 0;">
    <a href="#achievements" class="btn btn-outline-info rounded-pill" role="button" aria-label="View Achievements">üèÜ Achievements</a>
    <a href="#education" class="btn btn-outline-warning rounded-pill" role="button" aria-label="View Education">üéì Education</a>
    <a href="#skills" class="btn btn-outline-success rounded-pill" role="button" aria-label="View Skills">‚öôÔ∏è Skills</a>
    <a href="#gallery" class="btn btn-outline-light rounded-pill" role="button" aria-label="View Gallery">üì∏ Gallery</a>
    <a href="#social" class="btn btn-outline-danger rounded-pill" role="button" aria-label="Connect on Social Media">üåê Connect</a>
  </div>

  <button id="toggle-btn" class="btn btn-sm btn-outline-light position-absolute top-0 end-0 m-3" style="display: none;" aria-label="Hide header">
    Hide ‚úñÔ∏è
  </button>
</header>

<div id="show-header-btn" class="text-center my-3" style="display: none;">
  <button class="btn btn-info rounded-pill" aria-label="Show header">
    Show Header üåü
  </button>
</div>
{% endblock %}

{% block content %}
<div id="video-bg">
  <video muted loop class="video-bg" preload="metadata" poster="{% static 'images/video-fallback.jpg' %}" loading="lazy" onerror="this.style.display='none'; document.getElementById('video-bg').style.backgroundImage='url({% static 'images/video-fallback.jpg' %})';">
    <source src="{% static 'video/birds.webm' %}" type="video/webm">
    <source src="{% static 'video/birds.mp4' %}" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <button id="video-toggle" class="btn btn-sm btn-outline-light position-fixed bottom-0 end-0 m-3" aria-label="Pause video">Pause ‚è∏Ô∏è</button>
</div>

<section id="about-villen" class="container rounded-4 p-5 my-5 text-center">
  <h2 class="display-4 mb-4 fw-bold" style="color: #00a2ff;">Villen Bhai</h2>
  <p id="dynamic-about" class="fs-5"></p>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
  // Data arrays
  const techSkills = ['Python', 'C++', 'Java', 'Django', 'React.js', 'Kali Linux', 'Ethical Hacking', 'Cybersecurity', 'Network Security', 'Penetration Testing'];
  const passions = ['coding', 'ethical hacking', 'gaming (PUBG, Free Fire, GTA 5, Minecraft)', 'GATE exam prep', 'romantic shayari', 'life advice'];
  const values = ['relentless curiosity', 'unwavering dedication', 'a hunger for knowledge', 'passion for perfection', 'heart full of empathy', 'mind sharp like a blade', 'spirit that never settles'];
  const lifeQuotes = [
    '‚ÄúLife is a code ‚Äî sometimes buggy, always beautiful.‚Äù',
    '‚ÄúIn every failure lies the seed of a stronger comeback.‚Äù',
    '‚ÄúDream big, hustle hard, and code your destiny.‚Äù',
    '‚ÄúWhen passion leads, success follows.‚Äù',
    '‚ÄúThe greatest hack is to live authentically.‚Äù',
    '‚ÄúFrom the darkest nights emerge the brightest stars.‚Äù',
  ];

  // Utility functions
  const getRandom = arr => arr[Math.floor(Math.random() * arr.length)];
  const getRandomUnique = (arr, exclude = []) => {
    const available = arr.filter(item => !exclude.includes(item));
    return available[Math.floor(Math.random() * available.length)];
  };

  // Generate dynamic about text
  const generateAboutText = () => {
    const skill1 = getRandom(techSkills);
    const skill2 = getRandomUnique(techSkills, [skill1]);
    return `
      <p style="color: var(--color${Math.floor(Math.random() * 8) + 1});">By day, I wield my skills in <span class="fw-bold">${skill1}</span> and <span class="fw-bold">${skill2}</span>, crafting solutions that bridge logic and creativity.</p>
      <p style="color: var(--color${Math.floor(Math.random() * 8) + 1});">Driven by <span class="fw-semibold">${getRandom(values)}</span>, I dive deep into <span class="fw-semibold">${getRandom(passions)}</span>, whether it‚Äôs the thrill of ethical hacking or the poetry hidden in romantic shayari.</p>
      <p style="color: var(--color${Math.floor(Math.random() * 8) + 1});">Every challenge I face, every bug I squash, is a step toward mastery ‚Äî not just of code, but of life itself.</p>
      <p style="color: var(--color${Math.floor(Math.random() * 8) + 1});">I am Villen Bhai ‚Äî a seeker, a creator, a dreamer, and above all, a believer that the journey matters more than the destination.</p>
      <p style="color: var(--color${Math.floor(Math.random() * 8) + 1});"><em class="fw-bold fst-italic">${getRandom(lifeQuotes)}</em></p>
    `;
  };

  // Header toggle functionality
  const toggleHeader = () => {
    const header = document.getElementById('villen-header');
    const showBtn = document.getElementById('show-header-btn');
    if (header.style.display !== 'none') {
      header.style.display = 'none';
      showBtn.style.display = 'block';
    } else {
      header.style.display = 'block';
      showBtn.style.display = 'none';
    }
  };

  // Button visibility management
  const showButtons = (buttons) => {
    buttons.style.display = 'flex';
    setTimeout(() => buttons.style.opacity = 1, 50);
  };

  const hideButtons = (buttons) => {
    buttons.style.opacity = 0;
    setTimeout(() => buttons.style.display = 'none', 300);
  };

  // Initialize elements
  const dynamicAbout = document.getElementById('dynamic-about');
  const title = document.getElementById('villen-title');
  const buttons = document.getElementById('header-buttons');
  const toggleBtn = document.getElementById('toggle-btn');
  const video = document.querySelector('.video-bg');
  const videoToggle = document.getElementById('video-toggle');
  const aboutSection = document.getElementById('about-villen');

  // Set dynamic about text
  if (dynamicAbout) {
    dynamicAbout.innerHTML = generateAboutText();
  }

  // Header interactions
  if (title && buttons && toggleBtn) {
    let hideTimeout;
    title.addEventListener('mouseenter', () => {
      showButtons(buttons);
      toggleBtn.style.display = 'inline-block';
      clearTimeout(hideTimeout);
    });

    title.addEventListener('click', () => {
      showButtons(buttons);
      toggleBtn.style.display = 'inline-block';
      clearTimeout(hideTimeout);
      hideTimeout = setTimeout(() => {
        hideButtons(buttons);
        toggleBtn.style.display = 'none';
      }, 5000);
    });

    title.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        title.click();
      }
    });

    toggleBtn.addEventListener('click', toggleHeader);
    document.querySelector('#show-header-btn button').addEventListener('click', toggleHeader);
  }

  // Video controls
  if (video && videoToggle) {
    videoToggle.addEventListener('click', () => {
      if (video.paused) {
        video.play();
        videoToggle.textContent = 'Pause ‚è∏Ô∏è';
        videoToggle.setAttribute('aria-label', 'Pause video');
      } else {
        video.pause();
        videoToggle.textContent = 'Play ‚ñ∂Ô∏è';
        videoToggle.setAttribute('aria-label', 'Play video');
      }
    });

    window.addEventListener('load', () => {
      video.play().catch(() => console.log('Autoplay prevented by browser.'));
    });
  }

  // About section animation
  if (aboutSection) {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.2 });
    observer.observe(aboutSection);
  }
});
</script>
{% endblock %}

{% block extra_css %}
<style>
  :root {
    --color1: #1E90FF;
    --color2: #FF4500;
    --color3: #32CD32;
    --color4: #8A2BE2;
    --color5: #FFD700;
    --color6: #C71585;
    --color7: #00CED1;
    --color8: #FF8C00;
    --glow: #87cefa;
    --glow-shadow: #00bfff;
  }

  #video-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    z-index: -1;
    background-size: cover;
    background-position: center;
  }

  .video-bg {
    position: absolute;
    top: 50%;
    left: 50%;
    min-width: 100%;
    min-height: 100%;
    transform: translate(-50%, -50%);
    object-fit: cover;
    pointer-events: none;
    filter: brightness(0.3);
    width: 100%;
    height: 100%;
  }

  #about-villen {
    max-width: 850px;
    margin: 100px auto;
    padding: clamp(20px, 5vw, 30px);
    color: #ffffff;
    font-family: 'Segoe UI', sans-serif;
    font-size: clamp(1rem, 2.5vw, 1.1rem);
    background-color: rgba(0, 0, 0, 0.4);
    border-radius: 10px;
    backdrop-filter: blur(3px);
    text-align: center;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  #about-villen.visible {
    opacity: 1;
    transform: translateY(0);
  }

  #about-villen h2 {
    font-size: clamp(2rem, 5vw, 2.5rem);
    margin-bottom: 20px;
    letter-spacing: 1px;
  }

  #about-villen em {
    color: #00e5ff;
    font-weight: 500;
  }

  .glow {
    color: var(--glow);
    font-weight: bold;
    text-shadow: 0 0 10px var(--glow-shadow);
  }

  #header-buttons {
    transition: opacity 0.3s ease-in-out;
  }

  #villen-header h1 {
    font-size: clamp(2rem, 5vw, 3.5rem);
  }

  #header-buttons .btn {
    font-size: clamp(0.9rem, 2vw, 1rem);
    padding: 0.5rem 1.2rem;
    min-width: 44px;
    min-height: 44px;
  }
</style>
{% endblock %}